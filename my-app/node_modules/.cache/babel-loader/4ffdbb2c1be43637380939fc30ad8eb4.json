{"ast":null,"code":"import { call, put, race, delay } from \"redux-saga/effects\";\nimport { fetchSendEmail, fetch_create_user, fetch_login_user, fetchResetPassword } from \"../../../services/services_user\";\nimport { CURRENT_USER, HIDE_ERROR } from \"../../actions/types\";\n\nconst time = ms => {\n  function* wait(ms, result = true) {\n    console.log(5);\n  }\n};\n\nfunction* show_error() {\n  const {\n    score,\n    timeout\n  } = yield race({\n    score: call(time, 5000),\n    timeout: delay(2000)\n  });\n  console.log(score);\n\n  if (!score) {\n    yield put({\n      type: HIDE_ERROR\n    });\n  }\n}\n\nexport function* workerLoginUser(action) {\n  const user = action.user;\n  const {\n    history\n  } = action;\n  const login_user = {\n    username: user.username,\n    password: user.password\n  };\n\n  try {\n    const data = yield call(fetch_login_user, login_user);\n    localStorage.setItem('token', data.token);\n    const current_user = data.user;\n    yield put({\n      type: CURRENT_USER,\n      current_user\n    });\n    history.push('/todo/' + current_user.id);\n  } catch (error) {\n    console.log('ERROR_SAGA: ', error);\n    yield call(show_error);\n  }\n}\nexport function* workerCreateUser(action) {\n  const {\n    history\n  } = action;\n\n  try {\n    const data = yield call(fetch_create_user, action.user);\n\n    if (data.response === \"error\") {\n      yield call(show_error);\n    } else {\n      history.push('/');\n    }\n  } catch (error) {\n    console.log('ERROR_SAGA_SIGN_UP ', error);\n  }\n}\nexport function* workerResetPassword(action) {\n  const password = action.password;\n  const token = action.token;\n  const {\n    history\n  } = action;\n  yield call(fetchResetPassword, password, token, history);\n}\nexport function* workerSendEmail(action) {\n  const email = action.email;\n  const {\n    history\n  } = action;\n  yield call(fetchSendEmail, email, history);\n}","map":{"version":3,"sources":["/home/julia/ToDoList/my-app/src/store/saga/sagaUser/index.tsx"],"names":["call","put","race","delay","fetchSendEmail","fetch_create_user","fetch_login_user","fetchResetPassword","CURRENT_USER","HIDE_ERROR","time","ms","wait","result","console","log","show_error","score","timeout","type","workerLoginUser","action","user","history","login_user","username","password","data","localStorage","setItem","token","current_user","push","id","error","workerCreateUser","response","workerResetPassword","workerSendEmail","email"],"mappings":"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","sourcesContent":["import { call, put, race, delay } from \"redux-saga/effects\" ;\nimport { fetchSendEmail, fetch_create_user, fetch_login_user, fetchResetPassword } from \"../../../services/services_user\";\nimport { CURRENT_USER, HIDE_ERROR, SHOW_ERROR } from \"../../actions/types\";\nimport { IUser } from \"../../../interfaces/IUser\";\n\n\nconst time = (ms) => {\n    function* wait(ms, result=true) {\n        console.log(5)\n      }\n}\n\nfunction* show_error(){\n    const {score, timeout} = yield race({\n        score: call(time, 5000),\n        timeout: delay(2000)\n    })\n    console.log(score)\n    if (!score) {\n        yield put({type : HIDE_ERROR});\n    }\n}\n\nexport function* workerLoginUser(action) {\n    \n    const user : IUser = action.user;\n    const { history } = action;\n    const login_user = {\n        username : user.username,\n        password : user.password!\n    };\n    try{\n        const data  = yield call(fetch_login_user,login_user);\n        localStorage.setItem('token', data.token);\n        \n        const current_user = data.user;\n        yield put({type : CURRENT_USER, current_user});\n        \n        history.push('/todo/' + current_user.id);\n\n    }catch(error){\n        console.log('ERROR_SAGA: ', error);\n        yield call(show_error)\n    }\n}\n\nexport function* workerCreateUser(action){\n    \n    const { history } = action;\n    \n    try{\n        const data = yield call(fetch_create_user,action.user);\n        if (data.response === \"error\"){\n            yield call(show_error)\n        }else{\n            history.push('/');\n        }\n    }catch(error){\n        console.log('ERROR_SAGA_SIGN_UP ', error )\n    }\n}\n\nexport function* workerResetPassword(action){\n    const password : string = action.password;\n    const token = action.token\n    const { history }  = action;\n\n    yield call(fetchResetPassword, password, token, history);\n}\n\nexport function* workerSendEmail(action){\n    const email : string = action.email;\n    const { history }  = action;\n\n    yield call(fetchSendEmail, email, history);\n}"]},"metadata":{},"sourceType":"module"}