{"ast":null,"code":"import { call, delay, put, race, take } from \"redux-saga/effects\";\nimport { fetchSendEmail, fetchResetPassword } from \"../../../services/services_user\";\nimport { HIDE_ERROR } from \"../../actions/types\";\nimport { push } from 'connected-react-router';\nimport { hideErrorAction, showErrorAction } from \"../../actions\";\n\nfunction* show_error() {\n  yield put(showErrorAction());\n  const {\n    hideTimeout\n  } = yield race({\n    hide: take(HIDE_ERROR),\n    hideTimeout: delay(3e3)\n  });\n\n  if (hideTimeout) {\n    yield put(hideErrorAction());\n  }\n}\n\nexport function* workGetUser() {\n  yield console.log('get-user'); // try{\n  //     const current_user = yield call(fetchGetDataUser);\n  //     if(current_user !== undefined && current_user.id !== undefined){\n  //         yield put(onCurrentUserAction(current_user))\n  //         yield put (push('/todo'));\n  //     }else{\n  //         localStorage.removeItem('token');\n  //         yield put(onLogoutAction())\n  //     }\n  // } catch(error){\n  //     console.log('ERROR_SAGA ', error);\n  // }\n}\nexport function* workerLoginUser(action) {\n  const user = action.user;\n  const login_user = {\n    username: user.username,\n    password: user.password\n  };\n  yield console.log(login_user); // try{\n  //     const data  = yield call(fetchLoginUser,login_user);\n  //     localStorage.setItem('token', data.token);\n  //     const current_user = data.user;\n  //     yield put(onCurrentUserAction(current_user));\n  //     yield put(push('/todo'));\n  // }catch(error){\n  //     console.log('ERROR_SAGA: ', error);\n  //     yield call(show_error)\n  // }\n}\nexport function* workerCreateUser(action) {\n  yield console.log(action.user); // try{\n  //     const data = yield call(fetchCreateUser,action.user);\n  //     if (data){\n  //         yield call(show_error);\n  //     }else{\n  //         yield put(push('/'));\n  //     }\n  // }catch(error){\n  //     console.log('ERROR_SAGA_SIGN_UP ', error );\n  // }\n}\nexport function* workerResetPassword(action) {\n  const password = action.password;\n  const token = action.token;\n\n  try {\n    const data = yield call(fetchResetPassword, password, token);\n\n    if (data) {\n      yield call(show_error);\n    } else {\n      yield put(push('/'));\n    }\n  } catch (error) {\n    console.log('ERROR_SAGA ', error);\n  }\n}\nexport function* workerSendEmail(action) {\n  const email = action.email;\n\n  try {\n    yield call(fetchSendEmail, email);\n    yield put(push('/'));\n  } catch (error) {\n    console.log('ERROR_SAGA ', error);\n  }\n}","map":{"version":3,"sources":["/home/julia/ToDoList/my-app/src/store/saga/sagaUser/index.tsx"],"names":["call","delay","put","race","take","fetchSendEmail","fetchResetPassword","HIDE_ERROR","push","hideErrorAction","showErrorAction","show_error","hideTimeout","hide","workGetUser","console","log","workerLoginUser","action","user","login_user","username","password","workerCreateUser","workerResetPassword","token","data","error","workerSendEmail","email"],"mappings":"AAAA,SAASA,IAAT,EAAeC,KAAf,EAAsBC,GAAtB,EAA2BC,IAA3B,EAAiCC,IAAjC,QAA6C,oBAA7C;AACA,SAASC,cAAT,EAA0DC,kBAA1D,QAAsG,iCAAtG;AACA,SAASC,UAAT,QAA2B,qBAA3B;AAEA,SAASC,IAAT,QAAqB,wBAArB;AACA,SAASC,eAAT,EAA+DC,eAA/D,QAAsF,eAAtF;;AAGA,UAAUC,UAAV,GAAsB;AAElB,QAAMT,GAAG,CAACQ,eAAe,EAAhB,CAAT;AACA,QAAM;AAAEE,IAAAA;AAAF,MAAkB,MAAMT,IAAI,CAAC;AAC/BU,IAAAA,IAAI,EAAET,IAAI,CAACG,UAAD,CADqB;AAE/BK,IAAAA,WAAW,EAAEX,KAAK,CAAC,GAAD;AAFa,GAAD,CAAlC;;AAKA,MAAIW,WAAJ,EAAiB;AACb,UAAMV,GAAG,CAACO,eAAe,EAAhB,CAAT;AACH;AACJ;;AAED,OAAO,UAAUK,WAAV,GAAuB;AAC1B,QAAMC,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAN,CAD0B,CAE1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AAED,OAAO,UAAUC,eAAV,CAA0BC,MAA1B,EAAkC;AAErC,QAAMC,IAAY,GAAGD,MAAM,CAACC,IAA5B;AACA,QAAMC,UAAU,GAAG;AACfC,IAAAA,QAAQ,EAAGF,IAAI,CAACE,QADD;AAEfC,IAAAA,QAAQ,EAAGH,IAAI,CAACG;AAFD,GAAnB;AAIA,QAAMP,OAAO,CAACC,GAAR,CAAYI,UAAZ,CAAN,CAPqC,CAQrC;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACH;AAED,OAAO,UAAUG,gBAAV,CAA2BL,MAA3B,EAAkC;AACrC,QAAMH,OAAO,CAACC,GAAR,CAAYE,MAAM,CAACC,IAAnB,CAAN,CADqC,CAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AAED,OAAO,UAAUK,mBAAV,CAA8BN,MAA9B,EAAqC;AACxC,QAAMI,QAAiB,GAAGJ,MAAM,CAACI,QAAjC;AACA,QAAMG,KAAK,GAAGP,MAAM,CAACO,KAArB;;AACA,MAAI;AACA,UAAMC,IAAI,GAAG,MAAM1B,IAAI,CAACM,kBAAD,EAAqBgB,QAArB,EAA+BG,KAA/B,CAAvB;;AACA,QAAGC,IAAH,EAAQ;AACJ,YAAM1B,IAAI,CAACW,UAAD,CAAV;AACH,KAFD,MAEK;AACD,YAAMT,GAAG,CAACM,IAAI,CAAC,GAAD,CAAL,CAAT;AACH;AACJ,GAPD,CAOC,OAAMmB,KAAN,EAAY;AACTZ,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BW,KAA3B;AACH;AACJ;AAED,OAAO,UAAUC,eAAV,CAA0BV,MAA1B,EAAiC;AACpC,QAAMW,KAAc,GAAGX,MAAM,CAACW,KAA9B;;AAEA,MAAI;AACA,UAAM7B,IAAI,CAACK,cAAD,EAAiBwB,KAAjB,CAAV;AACA,UAAM3B,GAAG,CAACM,IAAI,CAAC,GAAD,CAAL,CAAT;AACH,GAHD,CAGC,OAAMmB,KAAN,EAAY;AACTZ,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BW,KAA3B;AACH;AAEJ","sourcesContent":["import { call, delay, put, race, take } from \"redux-saga/effects\" ;\nimport { fetchSendEmail, fetchCreateUser, fetchLoginUser, fetchResetPassword, fetchGetDataUser } from \"../../../services/services_user\";\nimport { HIDE_ERROR } from \"../../actions/types\";\nimport { IUser } from \"../../../interfaces/IUser\";\nimport { push } from 'connected-react-router';\nimport { hideErrorAction, onCurrentUserAction, onLogoutAction, showErrorAction } from \"../../actions\";\n\n\nfunction* show_error(){\n\n    yield put(showErrorAction());\n    const { hideTimeout } = yield race({\n        hide: take(HIDE_ERROR),\n        hideTimeout: delay(3e3),\n    });\n\n    if (hideTimeout) {\n        yield put(hideErrorAction())\n    }\n}\n\nexport function* workGetUser(){\n    yield console.log('get-user')\n    // try{\n    //     const current_user = yield call(fetchGetDataUser);\n    //     if(current_user !== undefined && current_user.id !== undefined){\n    //         yield put(onCurrentUserAction(current_user))\n    //         yield put (push('/todo'));\n    //     }else{\n    //         localStorage.removeItem('token');\n    //         yield put(onLogoutAction())\n    //     }\n    // } catch(error){\n    //     console.log('ERROR_SAGA ', error);\n    // }\n}\n\nexport function* workerLoginUser(action) {\n    \n    const user : IUser = action.user;\n    const login_user = {\n        username : user.username,\n        password : user.password!\n    };\n    yield console.log(login_user)\n    // try{\n    //     const data  = yield call(fetchLoginUser,login_user);\n    //     localStorage.setItem('token', data.token);\n        \n    //     const current_user = data.user;\n    //     yield put(onCurrentUserAction(current_user));\n    //     yield put(push('/todo'));\n\n    // }catch(error){\n    //     console.log('ERROR_SAGA: ', error);\n    //     yield call(show_error)\n    // }\n}\n\nexport function* workerCreateUser(action){\n    yield console.log(action.user)\n    // try{\n    //     const data = yield call(fetchCreateUser,action.user);\n    //     if (data){\n    //         yield call(show_error);\n    //     }else{\n    //         yield put(push('/'));\n    //     }\n    // }catch(error){\n    //     console.log('ERROR_SAGA_SIGN_UP ', error );\n    // }\n}\n\nexport function* workerResetPassword(action){\n    const password : string = action.password;\n    const token = action.token;\n    try {\n        const data = yield call(fetchResetPassword, password, token);\n        if(data){\n            yield call(show_error);\n        }else{\n            yield put(push('/'));\n        }\n    }catch(error){\n        console.log('ERROR_SAGA ', error );\n    }\n}\n\nexport function* workerSendEmail(action){\n    const email : string = action.email;\n\n    try {\n        yield call(fetchSendEmail, email);\n        yield put(push('/'));\n    }catch(error){\n        console.log('ERROR_SAGA ', error )\n    }\n    \n}"]},"metadata":{},"sourceType":"module"}