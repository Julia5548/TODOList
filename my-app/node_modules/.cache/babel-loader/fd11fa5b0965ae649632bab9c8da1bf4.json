{"ast":null,"code":"import { baseUrl } from \"./baseUrlRequest\";\n\nconst prepareBodyRequest = payload => {\n  return JSON.stringify(payload);\n};\n\nconst prepareHeadersRequest = token => {\n  let headers;\n  headers = {\n    'Content-type': 'application/json'\n  };\n\n  if (token) {\n    headers = { ...headers,\n      Authorization: `JWT ${token}`\n    };\n  }\n\n  return headers;\n};\n\nconst getResponseBody = async response => {\n  let data;\n  data = await response.json();\n  return {\n    data,\n    status: response.status,\n    statusText: response.statusText\n  };\n};\n\nconst request = async (url, data, token) => {\n  if (data.payload) {\n    data.body = prepareBodyRequest(data.payload);\n  }\n\n  data.mode = 'cors';\n  data.headers = prepareHeadersRequest(token);\n  const requestUrl = baseUrl + url;\n  let response;\n\n  try {\n    response = await fetch(requestUrl, data);\n  } catch (error) {\n    console.log(\"Что-то не так с сетью\");\n  }\n\n  const responseBody = await getResponseBody(response);\n\n  if (responseBody.status < 200 || responseBody.status >= 300) {\n    console.log(responseBody);\n    return {\n      error: responseBody.status\n    };\n  }\n\n  return response.ok ? {\n    response: responseBody\n  } : {\n    error: responseBody.data\n  };\n};\n\nexport const signIn = payload => request('token/auth/', {\n  method: 'POST',\n  payload\n});\nexport const signUp = payload => request('users/create/', {\n  method: 'POST',\n  payload\n});\nexport const currentUser = () => request('users/current/', {\n  method: 'GET'\n});\nexport const sendEmail = payload => request('password/reset/', {\n  method: 'POST',\n  payload\n});\nexport const resetPassword = payload => request('password/reset/confirm/', {\n  method: 'POST',\n  payload\n});\nexport const getTodos = () => request('detail/todos/', {\n  method: 'GET'\n}, localStorage.getItem('token'));\nexport const createTodo = payload => request('detail/todos/', {\n  method: 'POST',\n  payload\n}, localStorage.getItem('token'));\nexport const removeTodo = (payload, pk) => request(`detail/todo/${pk}`, {\n  method: 'DELETE',\n  payload\n}, localStorage.getItem('token'));\nexport const getTasks = todo => request(`detail/todo/task/list/${todo}`, {\n  method: 'GET'\n}, localStorage.getItem('token'));\nexport const createTask = payload => request('detail/todo/task/create', {\n  method: 'POST',\n  payload\n}, localStorage.getItem('token'));\nexport const toggleTask = payload => request('detail/todo/task/', {\n  method: 'PUT',\n  payload\n}, localStorage.getItem('token'));\nexport const removeTask = payload => request('detail/todo/task/', {\n  method: 'DELETE',\n  payload\n}, localStorage.getItem('token'));","map":{"version":3,"sources":["/home/julia/ToDoList/my-app/src/services/index.tsx"],"names":["baseUrl","prepareBodyRequest","payload","JSON","stringify","prepareHeadersRequest","token","headers","Authorization","getResponseBody","response","data","json","status","statusText","request","url","body","mode","requestUrl","fetch","error","console","log","responseBody","ok","signIn","method","signUp","currentUser","sendEmail","resetPassword","getTodos","localStorage","getItem","createTodo","removeTodo","pk","getTasks","todo","createTask","toggleTask","removeTask"],"mappings":"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","sourcesContent":["import { IUser } from \"../interfaces/IUser\";\nimport { baseUrl } from \"./baseUrlRequest\";\nimport { ITodoList } from \"../interfaces/ITodoList\";\nimport { ITask } from \"../interfaces/ITask\";\n\n\ntype Payload = Record<string, any>;\ntype Response = Record<string, any>;\n\ninterface RequestData<P extends Payload> extends RequestInit{\n    payload? : P;\n}\n\ninterface ResponseBody<R extends Response > {\n    data?: R;\n    status: number;\n    statusText: string;\n}\n  \ninterface ResponseData<R extends Response >{ \n    response?: ResponseBody<R>;\n    error?: any;\n}\n\n\nconst prepareBodyRequest = <T extends Payload>(payload: T) : string => {\n    return JSON.stringify(payload);\n}\n\nconst prepareHeadersRequest = (token?: string) : Record<string, string> => {\n\n    let headers : Record<string, string>;\n    headers = {\n        'Content-type' : 'application/json',\n    };\n\n    if(token) {\n        headers = {\n            ...headers,\n            Authorization : `JWT ${token}`\n        };\n    }\n    return headers;\n}\n\nconst getResponseBody = async <R extends Response>(response : Response) : Promise<ResponseBody<R>> => {\n    let data;\n    data = await response.json();\n    return {\n        data, \n        status : response.status,\n        statusText : response.statusText,\n    };\n}\n\nconst request = async <P extends Payload, R extends Response>(\n    url : string,\n    data: RequestData<P>,\n    token? : string,\n) : Promise<ResponseData<R>> => {\n\n    if(data.payload){\n        data.body = prepareBodyRequest<Payload>(data.payload);\n    }\n    \n    data.mode = 'cors';\n    data.headers = prepareHeadersRequest(token);\n \n    const requestUrl = baseUrl + url;\n    let response;\n    \n    try{\n        response = await fetch(requestUrl, data);\n    }catch(error){\n        console.log(\"Что-то не так с сетью\");\n    }\n\n    const responseBody = await getResponseBody<R>(response);\n    \n    if(responseBody.status < 200 || responseBody.status >= 300 ){\n        console.log(responseBody)\n        return {error : responseBody.status};\n    }\n\n    return response.ok \n    ? { response : responseBody}\n    : { error : responseBody.data};\n}\n\ninterface TokenResponse{\n    token : string;\n}\n\nexport const signIn =(payload : IUser) => request<IUser, TokenResponse >(\n    'token/auth/', { method : 'POST',  payload },\n);\n\nexport const signUp =(payload : IUser) => request<IUser, TokenResponse >(\n    'users/create/', { method : 'POST',  payload },\n);\n\nexport const currentUser =() => request<IUser, TokenResponse >(\n    'users/current/', { method : 'GET' },\n);\n\nexport const sendEmail =(payload : IUser) => request<IUser, TokenResponse >(\n    'password/reset/', { method : 'POST',  payload},\n);\n\nexport const resetPassword =(payload) => request<IUser, TokenResponse >(\n    'password/reset/confirm/', { method : 'POST',  payload },\n);\n\nexport const getTodos = () => request<ITodoList, TokenResponse >(\n    'detail/todos/', { method : 'GET' }, localStorage.getItem('token')!,\n);\n\nexport const createTodo =(payload : ITodoList) => request<ITodoList, TokenResponse >(\n    'detail/todos/', { method : 'POST',  payload }, localStorage.getItem('token')!,\n);\n\nexport const removeTodo =(payload : ITodoList, pk:number) => request<ITodoList, TokenResponse >(\n    `detail/todo/${pk}`, { method : 'DELETE',  payload }, localStorage.getItem('token')!,\n);\n\nexport const getTasks =(todo:number) => request<ITask, TokenResponse >(\n    `detail/todo/task/list/${todo}`, { method : 'GET' }, localStorage.getItem('token')!,\n);\n\nexport const createTask =(payload : ITask) => request<ITask, TokenResponse >(\n    'detail/todo/task/create', { method : 'POST',  payload }, localStorage.getItem('token')!,\n);\n\nexport const toggleTask =(payload : ITask) => request<ITask, TokenResponse >(\n    'detail/todo/task/', { method : 'PUT',  payload }, localStorage.getItem('token')!,\n);\n\nexport const removeTask =(payload : ITask) => request<ITask, TokenResponse >(\n    'detail/todo/task/', {method : 'DELETE',  payload}, localStorage.getItem('token')!,\n);"]},"metadata":{},"sourceType":"module"}