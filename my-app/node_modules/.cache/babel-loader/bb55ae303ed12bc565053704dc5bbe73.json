{"ast":null,"code":"import { call, delay, put } from \"redux-saga/effects\";\nimport { fetchSendEmail, fetchCreateUser, fetchLoginUser, fetchResetPassword, fetchGetDataUser } from \"../../../services/services_user\";\nimport { CURRENT_USER, HIDE_ERROR, SHOW_ERROR } from \"../../actions/types\";\n\nfunction* show_error() {\n  yield put({\n    type: SHOW_ERROR\n  });\n  yield delay(2000);\n  yield put({\n    type: HIDE_ERROR\n  });\n}\n\nexport function* workGetUser() {\n  try {\n    const data = yield call(fetchGetDataUser);\n    console.log(data);\n\n    if (data !== undefined && data.id !== undefined) {\n      onCurrentUser(user);\n      history.push(`/todo/${user.id}`);\n    } else {\n      localStorage.removeItem('token');\n      onLogout();\n    }\n  } catch (error) {\n    console.log('ERROR_SAGA ', error);\n  }\n}\nexport function* workerLoginUser(action) {\n  const user = action.user;\n  const {\n    history\n  } = action;\n  const login_user = {\n    username: user.username,\n    password: user.password\n  };\n\n  try {\n    const data = yield call(fetchLoginUser, login_user);\n    localStorage.setItem('token', data.token);\n    const current_user = data.user;\n    yield put({\n      type: CURRENT_USER,\n      current_user\n    });\n    history.push('/todo/' + current_user.id);\n  } catch (error) {\n    console.log('ERROR_SAGA: ', error);\n    yield call(show_error);\n  }\n}\nexport function* workerCreateUser(action) {\n  const {\n    history\n  } = action;\n\n  try {\n    const data = yield call(fetchCreateUser, action.user);\n\n    if (data.response === \"error\") {\n      yield call(show_error);\n    } else {\n      history.push('/');\n    }\n  } catch (error) {\n    console.log('ERROR_SAGA_SIGN_UP ', error);\n  }\n}\nexport function* workerResetPassword(action) {\n  const password = action.password;\n  const token = action.token;\n  const {\n    history\n  } = action;\n\n  try {\n    yield call(fetchResetPassword, password, token, history);\n  } catch (error) {\n    console.log('ERROR_SAGA ', error);\n  }\n}\nexport function* workerSendEmail(action) {\n  const email = action.email;\n  const {\n    history\n  } = action;\n\n  try {\n    yield call(fetchSendEmail, email, history);\n  } catch (error) {\n    console.log('ERROR_SAGA ', error);\n  }\n}","map":{"version":3,"sources":["/home/julia/ToDoList/my-app/src/store/saga/sagaUser/index.tsx"],"names":["call","delay","put","fetchSendEmail","fetchCreateUser","fetchLoginUser","fetchResetPassword","fetchGetDataUser","CURRENT_USER","HIDE_ERROR","SHOW_ERROR","show_error","type","workGetUser","data","console","log","undefined","id","onCurrentUser","user","history","push","localStorage","removeItem","onLogout","error","workerLoginUser","action","login_user","username","password","setItem","token","current_user","workerCreateUser","response","workerResetPassword","workerSendEmail","email"],"mappings":"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","sourcesContent":["import { call, delay, put } from \"redux-saga/effects\" ;\nimport { fetchSendEmail, fetchCreateUser, fetchLoginUser, fetchResetPassword, fetchGetDataUser } from \"../../../services/services_user\";\nimport { CURRENT_USER, HIDE_ERROR, SHOW_ERROR } from \"../../actions/types\";\nimport { IUser } from \"../../../interfaces/IUser\";\n\n\nfunction* show_error(){\n    yield put({type : SHOW_ERROR});\n    yield delay(2000);\n    yield put({type : HIDE_ERROR});\n}\n\nexport function* workGetUser(){\n\n    try{\n        const data = yield call(fetchGetDataUser);\n        console.log(data)\n        if(data !== undefined && data.id !== undefined){\n            onCurrentUser(user);\n            history.push(`/todo/${user.id}`);\n        }else{\n            localStorage.removeItem('token');\n            onLogout();\n        }\n    } catch(error){\n        console.log('ERROR_SAGA ', error);\n    }\n}\n\nexport function* workerLoginUser(action) {\n    \n    const user : IUser = action.user;\n    const { history } = action;\n    const login_user = {\n        username : user.username,\n        password : user.password!\n    };\n    try{\n        const data  = yield call(fetchLoginUser,login_user);\n        localStorage.setItem('token', data.token);\n        \n        const current_user = data.user;\n        yield put({type : CURRENT_USER, current_user});\n        \n        history.push('/todo/' + current_user.id);\n\n    }catch(error){\n        console.log('ERROR_SAGA: ', error);\n        yield call(show_error)\n    }\n}\n\nexport function* workerCreateUser(action){\n    \n    const { history } = action;\n    \n    try{\n        const data = yield call(fetchCreateUser,action.user);\n        if (data.response === \"error\"){\n            yield call(show_error)\n        }else{\n            history.push('/');\n        }\n    }catch(error){\n        console.log('ERROR_SAGA_SIGN_UP ', error )\n    }\n}\n\nexport function* workerResetPassword(action){\n    const password : string = action.password;\n    const token = action.token\n    const { history }  = action;\n    try {\n        yield call(fetchResetPassword, password, token, history);\n    }catch(error){\n        console.log('ERROR_SAGA ', error )\n    }\n}\n\nexport function* workerSendEmail(action){\n    const email : string = action.email;\n    const { history }  = action;\n    \n    try {\n        yield call(fetchSendEmail, email, history);\n    }catch(error){\n        console.log('ERROR_SAGA ', error )\n    }\n    \n}"]},"metadata":{},"sourceType":"module"}